HOME_ROOT=/opt/jupengfei/tool/.
. $HOME_ROOT/lib/libqd.sh

function gen_qd_commands {  
    local cur prev

    COMPREPLY=()
    cur=${COMP_WORDS[COMP_CWORD]}
    [ ${#COMP_WORDS} -gt 2 ] && return

    local top=`pwd`
    local items tmp_items=`get_cache_list`

    for tmp_item in $tmp_items; do
        items="$items ${tmp_item#$top/}"
    done
    items="$items `ls`"

    local delims=`echo $cur|tr ':' '\n'`

    for item in $items; do
        local tmp need=true

        for delim in $delims; do
            tmp=${item//$delim/}

            [ $tmp = $item ] && need=false
        done

        [ $need = true ] && COMPREPLY=(${COMPREPLY[@]} $item);
    done
}

complete -F gen_qd_commands qd
